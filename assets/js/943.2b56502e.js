"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[943],{5943:(Dt,z,d)=>{d.d(z,{diagram:()=>St});var a=d(1504),I=d(5625),P=d(7934),i=d(5322),J=d(7936),At=d(7484),bt=d(7967),ht=d(7856),ut=d(1644),ft=d(9354);const C="rect",R="rectWithTitle",Q="start",X="end",Z="divider",F="roundedWithTitle",m="note",q="noteGroup",D="statediagram",tt=`${D}-state`,$="transition",et="note",st=`${$} note-edge`,ot=`${D}-${et}`,nt=`${D}-cluster`,ct=`${D}-cluster-alt`,G="parent",v="note",it="state",O="----",rt=`${O}${v}`,B=`${O}${G}`,N="fill:none",w="fill: #333",U="c",W="text",k="normal";let g={},_=0;const lt=function(t){const n=Object.keys(t);for(const e of n)t[e]},dt=function(t,n){return n.db.extract(n.db.getRootDocV2()),n.db.getClasses()};function at(t){return t==null?"":t.classes?t.classes.join(" "):""}function M(t="",n=0,e="",c=O){const r=e!==null&&e.length>0?`${c}${e}`:"";return`${it}-${t}${r}-${n}`}const h=(t,n,e,c,r,l)=>{const s=e.id,u=at(c[s]);if(s!=="root"){let A=C;e.start===!0&&(A=Q),e.start===!1&&(A=X),e.type!==a.D&&(A=e.type),g[s]||(g[s]={id:s,shape:A,description:i.e.sanitizeText(s,(0,i.c)()),classes:`${u} ${tt}`});const o=g[s];e.description&&(Array.isArray(o.description)?(o.shape=R,o.description.push(e.description)):o.description.length>0?(o.shape=R,o.description===s?o.description=[e.description]:o.description=[o.description,e.description]):(o.shape=C,o.description=e.description),o.description=i.e.sanitizeTextOrArray(o.description,(0,i.c)())),o.description.length===1&&o.shape===R&&(o.shape=C),!o.type&&e.doc&&(i.l.info("Setting cluster for ",s,x(e)),o.type="group",o.dir=x(e),o.shape=e.type===a.a?Z:F,o.classes=o.classes+" "+nt+" "+(l?ct:""));const b={labelStyle:"",shape:o.shape,labelText:o.description,classes:o.classes,style:"",id:s,dir:o.dir,domId:M(s,_),type:o.type,padding:15};if(b.centerLabel=!0,e.note){const E={labelStyle:"",shape:m,labelText:e.note.text,classes:ot,style:"",id:s+rt+"-"+_,domId:M(s,_,v),type:o.type,padding:15},S={labelStyle:"",shape:q,labelText:e.note.text,classes:o.classes,style:"",id:s+B,domId:M(s,_,G),type:"group",padding:0};_++;const f=s+B;t.setNode(f,S),t.setNode(E.id,E),t.setNode(s,b),t.setParent(s,f),t.setParent(E.id,f);let T=s,p=E.id;e.note.position==="left of"&&(T=E.id,p=s),t.setEdge(T,p,{arrowhead:"none",arrowType:"",style:N,labelStyle:"",classes:st,arrowheadStyle:w,labelpos:U,labelType:W,thickness:k})}else t.setNode(s,b)}n&&n.id!=="root"&&(i.l.trace("Setting node ",s," to be child of its parent ",n.id),t.setParent(s,n.id)),e.doc&&(i.l.trace("Adding nodes children "),_t(t,e,e.doc,c,r,!l))},_t=(t,n,e,c,r,l)=>{i.l.trace("items",e),e.forEach(s=>{switch(s.stmt){case a.b:h(t,n,s,c,r,l);break;case a.D:h(t,n,s,c,r,l);break;case a.S:{h(t,n,s.state1,c,r,l),h(t,n,s.state2,c,r,l);const u={id:"edge"+_,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:N,labelStyle:"",label:i.e.sanitizeText(s.description,(0,i.c)()),arrowheadStyle:w,labelpos:U,labelType:W,thickness:k,classes:$};t.setEdge(s.state1.id,s.state2.id,u,_),_++}break}})},x=(t,n=a.c)=>{let e=n;if(t.doc)for(let c=0;c<t.doc.length;c++){const r=t.doc[c];r.stmt==="dir"&&(e=r.value)}return e},Et={setConf:lt,getClasses:dt,draw:async function(t,n,e,c){i.l.info("Drawing state diagram (v2)",n),g={},c.db.getDirection();const{securityLevel:r,state:l}=(0,i.c)(),s=l.nodeSpacing||50,u=l.rankSpacing||50;i.l.info(c.db.getRootDocV2()),c.db.extract(c.db.getRootDocV2()),i.l.info(c.db.getRootDocV2());const A=c.db.getStates(),o=new I.k({multigraph:!0,compound:!0}).setGraph({rankdir:x(c.db.getRootDocV2()),nodesep:s,ranksep:u,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}});h(o,void 0,c.db.getRootDocV2(),A,c.db,!0);let b;r==="sandbox"&&(b=(0,P.Ys)("#i"+n));const E=r==="sandbox"?(0,P.Ys)(b.nodes()[0].contentDocument.body):(0,P.Ys)("body"),S=E.select(`[id="${n}"]`),f=E.select("#"+n+" g");await(0,J.r)(f,o,["barb"],D,n);const T=8;i.u.insertTitle(S,"statediagramTitleText",l.titleTopMargin,c.db.getDiagramTitle());const p=S.node().getBBox(),H=p.width+T*2,K=p.height+T*2;S.attr("class",D);const j=S.node().getBBox();(0,i.i)(S,K,H,l.useMaxWidth);const V=`${j.x-T} ${j.y-T} ${H} ${K}`;i.l.debug(`viewBox ${V}`),S.attr("viewBox",V);const Tt=document.querySelectorAll('[id="'+n+'"] .edgeLabel .label');for(const L of Tt){const Y=L.getBBox(),y=document.createElementNS("http://www.w3.org/2000/svg",C);y.setAttribute("rx",0),y.setAttribute("ry",0),y.setAttribute("width",Y.width),y.setAttribute("height",Y.height),L.insertBefore(y,L.firstChild)}}},St={parser:a.p,db:a.d,renderer:Et,styles:a.s,init:t=>{t.state||(t.state={}),t.state.arrowMarkerAbsolute=t.arrowMarkerAbsolute,a.d.clear()}}}}]);
